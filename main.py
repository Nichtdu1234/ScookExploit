import requests
import api
from os import system

# Registration = input("Register by using unity session/ Username + Password?\nu/p: ")
# if Registration.lower() == "u":
# currently only supports unity session

print("Warning: Running this program too often (like 100 times) in a short time may suggest to scook that you are abusing this exploit!\n")
api.init(input("Unity Session: "))

assignmentids = api.AssignmentIds()
students = api.GetStudents(assignmentids)
tasks = api.GetTasks(assignmentids)
system("cls")

while True:
    action = input("\n[1]: Search for a specific classmate.\n[2]: Show information about a specific classmate. (full name)\n[3]: Search for a specific task.\n[4]: Show information about a specific task.\n[5]: Show classmate emails.\nAction: ")
    if action == "1":
        Input = input("Who to search for: ").lower()
        print('')
        temp = []
        for student in students:
            if student.startswith(Input): temp.append(students[student].name)
        if len(temp) > 0:
            print(str(len(temp)) + " students found.")
            for student in temp: print(student)
        else: print("No students found.")

    if action == "2":
        Input = input("Who: ").lower()
        print("")
        if Input in students: print(students[Input])
        else: print("Student not found. Make sure you used the full name.")

    if action == "3":
        Input = input("What task to search for: ").lower()
        print("")
        temp = []
        for task in tasks:
            if task.lower().startswith(Input): temp.append(task)
        if len(temp) > 0:
            print(str(len(temp)) + " tasks found.")
            for task in temp: print(task)
        else: print("No tasks with this name found.")

    if action == "4":
        Input = input("Task: ").lower()
        print("")
        if Input in tasks: print(tasks[Input])
        else: print("Task not found. Make sure you used the full name.")

    if action == "5":
        print("")
        for student in students:
            print(students[student].email)